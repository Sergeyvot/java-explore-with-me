# ExploreWithMe (дипломный проект)

![Изображение](https://nevmuseum.ru/uploaded/thumbnails/8909_610x400_fit_and_crop-1295914768.jpg)

## Функциональность

Backend приложения - сервиса афиши. Дает возможность предложить какое-либо событие и собрать пользователей для участия.
Каждое событие должно относиться к какой-то из закреплённых в приложении категорий.

Приложение состоит из двух сервисов:
- **основной сервис** (бизнес-логика, взаимодействие с основной БД);
- **сервис статистики** (хранение количества просмотров, возможность делать выборки для анализа работы приложения);

API ***основного сервиса*** разделен на три части:
- *публичная* доступна без регистрации любому пользователю сети;
- *закрытая* доступна только авторизованным пользователям;
- *административная* — для администраторов сервиса.

Публичный API предоставляет возможности поиска и фильтрации событий. Каждый публичный запрос для получения 
списка событий или полной информации о мероприятии фиксируется сервисом статистики.

API для авторизованных пользователей дает возможность:
- добавлять в приложение новые мероприятия, редактировать их и просматривать после добавления;
- подача заявок на участие в интересующих мероприятиях;
- создателю мероприятия подтверждать заявки, которые отправили другие пользователи сервиса.

Возможности API для администратора:
- добавление, изменение и удаление категорий для событий;
- добавление, удаление и закрепление на главной странице подборки мероприятий;
- модерация событий, размещённых пользователями — публикация или отклонение;
- управление пользователями — добавление, активация, просмотр и удаление.

Жизненный цикл события должен включать:
1. Создание.
2. Ожидание публикации.
3. Публикация. В это состояние событие переводит администратор.
4. Отмена публикации (по инициативе администратора или инициатора события на этапе ожидания публикации).

Согласно ТЗ, аутентификация и авторизация осуществляется на внешнем сетевом шлюзе, в приложении
не реализуется.

Контроллеры организованы по типам API. Пакеты с сервисной логикой, репозиториями, моделями DTO организованы
по сущностям.

***Сервис статистики*** собирает информацию о количестве обращений пользователей к спискам событий и, 
о количестве запросов к подробной информации о событии. На данной основе формируется статистика о работе приложения.

Функционал сервиса статистики:
- запись информации о том, что был обработан запрос к эндпоинту API;
- предоставление статистики за выбранные даты по выбранному эндпоинту.

Взаимодействие с *основным сервисом* через HTTP-клиент.

Каждый сервис приложения и его БД запускаются в отдельном Docker-контейнере.

**Дополнительная функциональность** не прописана требованиями ТЗ, выбиралась и реализовывалась самостоятельно:

Добавлена возможность пользователям, участвовавшим в событии, оставлять комментарии.

Основной функционал доступен через PrivateController:
- добавить комментарий (доступно только для пользователей, чьи заявки на участие в событии
имеют статус Confirmed);
- изменить комментарий (если статус комментария PENDING или REJECTED);
- удалить комментарий (только автором комментария);
- запросить информацию по своему комментарию (только для автора комментария);
- запросить все комментарии по событию (только для инициатора события);

Для PublicController:
- запросить комментарии к событию с заданной пагинацией (только опубликованные);

Для AdminController:
- изменить статус комментария, находящегося в ожидании, на PUBLISHED или REJECTED;
Данная опция добавлена для предварительной модерации комментариев, чтобы не публиковались
комментарии, нарушающие законодательство

Подразумевалось, что оставлять комментарии можно к уже прошедшему событию. Но технически
прописать данную валидацию не получилось, так как иначе бы не получилось пройти тесты - 
нельзя создать событие для тестирования с eventDate в прошедшем времени.

Соответственно, в выходные варианты Dto по событиям (EventFullDto, EventShortDto) добавлено
поле List<CommentDto> comments. Наполняется при формировании экземпляра Dto Event

### Технологии, стек

Многомодульный проект Maven. Spring Boot. PostgreSQL. Docker.
Взаимодействие с БД - Hibernate.
Составление базовых тестов Postman для проверки работы дополнительной функциональности.